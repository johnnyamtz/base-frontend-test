(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(t,e,a){t.exports=a(11)},11:function(t,e,a){"use strict";a.r(e);var n=a(4),r=a(5),s=a(8),l=a(6),i=a(9),c=a(0),u=a.n(c),o=a(7),m=a.n(o),d=a(2),h=a.n(d),v=a(1);a(18);function p(t){return u.a.createElement("div",{className:(t.data.cnt+2)%2===0?"row1":"row2"},u.a.createElement("tr",{id:t.data.id},u.a.createElement("td",{className:"col1"},t.data.datetime),u.a.createElement("td",{className:"col2"},u.a.createElement("input",{className:"values",type:"number",name:"val1",id:t.data.id,value:t.data.value1,onChange:t.onChange})),u.a.createElement("td",{className:"col3"},u.a.createElement("input",{className:"values",type:"number",name:"val2",id:t.data.id,value:t.data.value2,onChange:t.onChange}))))}function g(t){return u.a.createElement("select",{className:"time",name:"tiempo",value:t.value,onChange:t.onChange,autoFocus:!0},u.a.createElement("option",{value:"1"},"Last hour"),u.a.createElement("option",{value:"3"},"Last 3 hours"),u.a.createElement("option",{value:"6"},"Last 6 hours"),u.a.createElement("option",{value:"12"},"Last 12 hours"))}var f=function(t){function e(t){var a;return Object(n.a)(this,e),(a=Object(s.a)(this,Object(l.a)(e).call(this,t))).state={action:"get",stateResult:0,message:"",quantity:0,old:1,rangeTime:"",minValY:0,maxValY:0,dataGraph:[],valsY1:[],valsY2:[],dates:[]},a}return Object(i.a)(e,t),Object(r.a)(e,[{key:"componentWillMount",value:function(){this.getDataFromSrvr(this.state.old)}},{key:"handleSelected",value:function(t){this.getDataFromSrvr(t.target.value)}},{key:"getParametersURL",value:function(t){var e=new h.a,a="";return a="&end="+e.format().substring(0,19)+"&",a="start="+e.subtract(t,"hours").format().substring(0,19)+a}},{key:"getMaxMin",value:function(){var t=0,e=0;this.state.valsY1.forEach(function(a){t=t<a.y?t:a.y,e=e>a.y?e:a.y}),this.state.valsY2.forEach(function(a){t=t<a.y?t:a.y,e=e>a.y?e:a.y}),this.setState({minValY:t,maxValY:e})}},{key:"getDataFromSrvr",value:function(t){var e=this;this.setState({action:"get",stateResult:0,quantity:0,old:t,rangeTime:"",minValY:0,maxValY:0,dataGraph:[],valsY1:[],valsY2:[],dates:[]});var a="",n="http://localhost:8080/reading/?"+this.getParametersURL(t);fetch(n).then(function(t){return e.setState({stateResult:t.status,message:t.statusText,quantity:-1}),t.json()}).then(function(t){var n=0;t.forEach(function(t){var r={cnt:n,key:t.id,datetime:t.timestamp,value1:t.value1,value2:t.value2};0===n&&e.setState({rangeTime:new h.a(r.datetime).format("hh:mm")+" - "});var s={y:r.value1},l={y:r.value2};e.setState({dataGraph:e.state.dataGraph.concat([r]),quantity:n+1,valsY1:e.state.valsY1.concat([s]),valsY2:e.state.valsY2.concat([l]),dates:e.state.dates.concat([new h.a(r.datetime).format("hh:mm")])}),a=new h.a(r.datetime).format("hh:mm"),n++}),e.getMaxMin(),200===e.state.stateResult&&e.state.quantity>0?(e.setState({rangeTime:e.state.rangeTime+a}),e.paintGraph()):e.setState({quantity:0})}).catch(function(t){console.log(t)})}},{key:"handleChange",value:function(t,e){var a=this,n=this.state.dataGraph,r=[];"val1"===t.target.name?(n[e].value1=t.target.value,(r=this.state.valsY1)[e]={y:t.target.value},this.setState({valsY1:r})):"val2"===t.target.name&&(n[e].value2=t.target.value,(r=this.state.valsY2)[e]={y:t.target.value},this.setState({valsY2:r})),this.getMaxMin(),fetch("http://localhost:8080/reading/",{id:"updateReading",name:"put",request:JSON.stringify({id:n[e].key,timestamp:n[e].datetime,value1:n[e].value1,value2:n[e].value2})}).then(function(t){a.setState({stateResult:t.status,message:t.statusText,dataGraph:n,action:"put"}),a.paintGraph()})}},{key:"paintGraph",value:function(){var t=this.state.dataGraph.length,e=Number(this.state.maxValY)+2;e=e<0?0:e;var a=Number(this.state.minValY)-2;a=a>0?0:a;var n="("+this.state.rangeTime+")",r="("+Math.round(a)+" - "+Math.round(e)+")",s=this.state.valsY1,l=this.state.valsY2,i=[s,l],c=this.state.dates;v.h("g").remove("g");var u=v.h("svg"),o=50,m=50,d=50,h=50,p=+u.attr("width")-m-h,g=+u.attr("height")-o-d,f=v.g().domain([0,t-1]).range(c),y=v.f().domain(f.range()).range([0,p]),E=v.e().domain([0,t-1]).range([0,p]),b=v.e().domain([a,e]).range([g,0]),Y=u.append("g").attr("transform","translate("+m+", "+o+")");Y.append("text").attr("class","label").attr("x",p).attr("y",u.attr("height")-65).text("Time "+n),Y.append("text").attr("class","label").attr("x",0).attr("y",-25).attr("transform","rotate(-90)").text("Values "+r),Y.append("g").attr("transform","translate(0, "+g+")").call(v.a(y)),Y.append("g").call(v.b(b)),Y.append("g").attr("class","axis-linear").attr("transform","translate(0, "+b(0)+")").call(v.a(E));var N=v.d().x(function(t,e){return E(e)}).y(function(t){return b(t.y)}).curve(v.c);Y.append("g").selectAll("path").data(i).enter().append("path").attr("class","line").attr("stroke",function(t,e){return["#b73535","#3546b7"][e]}).attr("d",N),Y.append("g").selectAll(".dot").data(s).enter().append("circle").attr("class","dot1").attr("cx",function(t,e){return E(e)}).attr("cy",function(t){return b(t.y)}).attr("r",3),Y.append("g").selectAll(".dot").data(l).enter().append("circle").attr("class","dot2").attr("cx",function(t,e){return E(e)}).attr("cy",function(t){return b(t.y)}).attr("r",3)}},{key:"render",value:function(){var t=this;return 200===this.state.stateResult?this.state.quantity>0?u.a.createElement("div",null,u.a.createElement("div",null,u.a.createElement(g,{qty:this.state.old,value:this.state.old,onChange:function(e){return t.handleSelected(e)}})),u.a.createElement("div",null,u.a.createElement("svg",{width:"960",height:"480"})),u.a.createElement("div",null,u.a.createElement("table",{className:"table-data",name:"data"},u.a.createElement("tbody",null,u.a.createElement("thead",null,u.a.createElement("div",{className:"rowH"},u.a.createElement("tr",null,u.a.createElement("th",{className:"col1"},"Date/Time"),u.a.createElement("th",{className:"col2"},"Value 1"),u.a.createElement("th",{className:"col3"},"Value 2")))),u.a.createElement("tbody",null,this.state.dataGraph.map(function(e){return u.a.createElement(p,{key:e.key,data:e,onChange:function(a){return t.handleChange(a,e.cnt)}})})))))):-1===this.state.quantity?u.a.createElement("div",null,u.a.createElement("p",{className:"data-updating"},"Loading data...")):u.a.createElement("div",null,u.a.createElement(g,{qty:this.state.old,value:this.state.old,onChange:function(e){return t.handleSelected(e)}}),u.a.createElement("p",{className:"no-data-found"},"No data was obtained, please select another option.")):500===this.state.stateResult?u.a.createElement("div",null,u.a.createElement("p",{className:"server-error"},"It was not possible to make the request, please try again.")):400!==this.state.stateResult?0===this.state.stateResult?u.a.createElement("div",null,u.a.createElement("p",{className:"data-updating"},"Loading data...")):u.a.createElement("div",null,u.a.createElement("p",{className:"server-error"},"It has not been possible to make the request to the server, code: ",this.state.stateResult,".",u.a.createElement("br",null),'The message returned by the server is: "',this.state.message,'".')):"get"===this.state.action?u.a.createElement("div",null,u.a.createElement("p",{className:"server-error"},"An error occurred when requesting the information, please verify the format of the date, it must be in ISO8601 format * without * time zone.")):"put"===this.state.action?u.a.createElement("div",null,u.a.createElement("p",{className:"server-error"},"The request made, could not be found. Please try again.")):void 0}}]),e}(u.a.Component);m.a.render(u.a.createElement(f,null),document.getElementById("root"))},18:function(t,e,a){}},[[10,2,1]]]);
//# sourceMappingURL=main.9387854b.chunk.js.map